<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Test Post | TM Log</title><meta name=keywords content="docker,pgcli,postgres"><meta name=description content="Desc Text."><meta name=author content="TM"><link rel=canonical href=https://canonical.url/to/page><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.bc1149f4a72aa4858d3a9f71462f75e5884ffe8073ea9d6d5761d5663d651e20.css integrity="sha256-vBFJ9KcqpIWNOp9xRi915YhP/oBz6p1tV2HVZj1lHiA=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG+9vmJ0cTS+ovo0FeA=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://tayyabmujahid.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=https://tayyabmujahid.github.io/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=https://tayyabmujahid.github.io/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=https://tayyabmujahid.github.io/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=https://tayyabmujahid.github.io/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="Test Post"><meta property="og:description" content="Desc Text."><meta property="og:type" content="article"><meta property="og:url" content="https://tayyabmujahid.github.io/posts/test_post/"><meta property="og:image" content="https://tayyabmujahid.github.io/%3Cimage%20path/url%3E"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-11-30T11:53:24+03:00"><meta property="article:modified_time" content="2022-11-30T11:53:24+03:00"><meta property="og:site_name" content="TM Log"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://tayyabmujahid.github.io/%3Cimage%20path/url%3E"><meta name=twitter:title content="Test Post"><meta name=twitter:description content="Desc Text."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://tayyabmujahid.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Test Post","item":"https://tayyabmujahid.github.io/posts/test_post/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Test Post","name":"Test Post","description":"Desc Text.","keywords":["docker","pgcli","postgres"],"articleBody":"Week 1 Main Notes, other notes\nDocker + Postgres 1: Create Dockerfile that would be used to build Docker image Dockerfile is a text document containing commands that can be run on CLI to create a Docker image\nMost Dockerfiles start from a parent image. If you need to completely control the contents of your image, you might need to create a base image instead. Here’s the difference:\nA parent image is the image that your image is based on. It refers to the contents of the FROM directive in the Dockerfile. Each subsequent declaration in the Dockerfile modifies this parent image. Most Dockerfiles start from a parent image, rather than a base image. However, the terms are sometimes used interchangeably. A base image has FROM scratch in its Dockerfile. a. Dockerfile Docker commands used in the Dockerfile:\nFROM python:3.9: installs the base image for the image,\nRUN pip install pandas will the run any commands that,\nWORKDIR /app will create directory where the files of the image will be stored,\nCOPY pipeline.py pipeline.py will copy the files from the local pc directory where the file is to the WORKDIR\nENTRYPOINT [\"python\",\"pipeline.py\"] directive in a Dockerfile allows the containers created from the image to run an executable after creation. ENTRYPOINT has two forms exec form and shell form. Here in the basic Dockerfile the exec form of entry point is being used.\nb. Building the image docker build -t test:pandas : this command was used to build the test image with a tag of pandas\nc. running a container of the image docker run -it test:pandas 2021-05-15 to this parameters can be passed as the pipeline.py is able to accept parameters using sys.argv.\nOne the container is run the only purpose of this container is to run the pipeline.py and the container closes once the execution of the container is completed.\n2. Postgres This step creates an image of Postgres db and uses pgcli to access the database\nfor running a Postgres container the following command is used docker run -it \\ -e POSTGRES_USER=\"root\" \\ # The name of our PostgreSQL user -e POSTGRES_PASSWORD=\"root\" \\ # The password for our user -e POSTGRES_DB=\"ny_taxi\" \\ # The name we want for our database -v /home/mujahid/PycharmProjects/zoomcamp_de/week1/ny_taxi_postgres_data \\ :/var/lib/postgresql/data \\ -p 5432:5432 \\ # This maps a postgres port on our host machine to one in our containe postgres:13 -v flag - volumes is a way to map the folder on the container to the host machine file system to physically store the records. Docker doesn’t keep the state next time when the container is started data must be available. We need to mount the folder on the host machine to the docker container.\nPort on the host machine must also be mapped to the port on the docker container to access the Postgres database\nthe docker run command looks for an image of postgres:13 if it does not find one then downloads it and creates an image and then runs a container\nSide note: if the port is busy us this to find the process at running at the port[url] sudo ss -lptn 'sport = :5432' and then kill With the container running now we can access it\nAccessing the Postgres db with pgcli install pgcli - its a client for Postgres\npip install pgcli then connect to the pgcli client to the database\npgcli -h localhost -p 5432 -u root -d ny_taxi and then check list of tables using\nroot@localhost:nytaxi\u003e \\dt 3. Populating Postgres db with Taxi rides dataset The goal here is to\nCreate a table (by generating schema) in the database to match the dataframe datatype.\nload the data into the database chunk by chunk using an iterator as the taxi dataset has more than a million rows.\nDownload data and convert to timestamp datatype for columns with timestamp related information\nDownload the data from here\nthe data here is .paraquet format convert that to .csv using df.to_csv so that data can be handled easily and loaded in chunks.\nconvert time related to colums to timestamp datatype using pd.to_datetime\nCreate schema from the dataframe of the dataset for creating table in the database\ninstall sqlalchemy\npip install sqlalchemy to load this taxi data into the database first a table needs to be created. To generate a schema for the table to generate a DDL(data description language) statement using the following statement\npd.is.sql.get_schema(df,name=\"yello_taxi_data\") using sqlalchemy create_engine generate correct Postgres compatible format of DDL and pass this connection engine to .get_schema statement to generate the schema\nUse this DDL statement to create table in the postgres database\n# This creates a connection to the postgres db that is active at port 5432 engine = create_engine('postgresql://root:root@localhost:5432/ny_taxi') engine.connect() # This creates a schema for postgres db with a connection at `con` print(pd.io.sql.get_schema(df,name='yellow_taxi_data',con=engine)) Load Data in chunks\nLoad the df in chunks using and iterator so that we dont enter\nuse the iterator=True for the read_csv statement; this converts the df to a standard python iterator. next(df) can be used to access the chunks Write data into the table\n#this creates only the table with the schema of df but does not add any data as df.head(0) df.head(0).to_sql(name='yellow_taxi_data',con=engine,if_exists='replace') # this appends data(but chunk wise) to the table df.to_sql(name='yellow_taxi_data',con=engine,if_exists='append') To enter all the chunks the following code can be used\nwhile True: t_start = time() df = next(df_iter) df.tpep_pickup_datetime= pd.to_datetime(df.tpep_pickup_datetime) df.tpep_dropoff_datetime= pd.to_datetime(df.tpep_dropoff_datetime) df.to_sql(name='yellow_taxi_data',con=engine,if_exists='append') t_end = time() print('inserted another chunk, took %.3f second '%(t_end-t_start)) video\nReferences\nhttps://github.com/ABZ-Aaron/DataEngineerZoomCamp/tree/master/week_1_basics_n_setup\n","wordCount":"912","inLanguage":"en","image":"https://tayyabmujahid.github.io/%3Cimage%20path/url%3E","datePublished":"2022-11-30T11:53:24+03:00","dateModified":"2022-11-30T11:53:24+03:00","author":{"@type":"Person","name":"TM"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://tayyabmujahid.github.io/posts/test_post/"},"publisher":{"@type":"Organization","name":"TM Log","logo":{"@type":"ImageObject","url":"https://tayyabmujahid.github.io/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://tayyabmujahid.github.io/ accesskey=h title="TM Log (Alt + H)"><img src=https://tayyabmujahid.github.io/apple-touch-icon.png alt aria-label=logo height=35>TM Log</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://tayyabmujahid.github.io/categories/ title=Categories><span>Categories</span></a></li><li><a href=https://tayyabmujahid.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://tayyabmujahid.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://tayyabmujahid.github.io/posts/>Posts</a></div><h1 class=post-title>Test Post</h1><div class=post-description>Desc Text.</div><div class=post-meta><span title='2022-11-30 11:53:24 +0300 +03'>November 30, 2022</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;912 words&nbsp;·&nbsp;TM&nbsp;|&nbsp;<a href=https://github.com/%3cpath_to_repo%3e/content/posts/test_post.md rel="noopener noreferrer" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#docker--postgres>Docker + Postgres</a><ul><li></li></ul></li></ul></nav></div></details></div><div class=post-content><h1 id=week-1>Week 1<a hidden class=anchor aria-hidden=true href=#week-1>#</a></h1><p><a href=https://docs.google.com/document/d/e/2PACX-1vRJUuGfzgIdbkalPgg2nQ884CnZkCg314T_OBq-_hfcowPxNIA0-z5OtMTDzuzute9VBHMjNYZFTCc1/pub>Main Notes</a>, <a href=https://github.com/ABZ-Aaron/DataEngineerZoomCamp/tree/master/week_1_basics_n_setup>other notes</a></p><h2 id=docker--postgres>Docker + Postgres<a hidden class=anchor aria-hidden=true href=#docker--postgres>#</a></h2><h4 id=1-create-dockerfile-that-would-be-used-to-build-docker-image>1: Create <code>Dockerfile</code> that would be used to build Docker image<a hidden class=anchor aria-hidden=true href=#1-create-dockerfile-that-would-be-used-to-build-docker-image>#</a></h4><p><code>Dockerfile</code> is a text document containing commands that can be run on CLI to create a <strong>Docker image</strong></p><p>Most Dockerfiles start from a parent image. If you need to completely control the contents of your image, you might need to create a base image instead. Here’s the difference:</p><ul><li>A <a href=https://docs.docker.com/glossary/#parent-image>parent image</a> is the image that your image is based on. It refers to the contents of the <code>FROM</code> directive in the Dockerfile. Each subsequent declaration in the Dockerfile modifies this parent image. Most Dockerfiles start from a parent image, rather than a base image. However, the terms are sometimes used interchangeably.</li><li>A <a href=https://docs.docker.com/glossary/#base-image>base image</a> has <code>FROM scratch</code> in its Dockerfile.</li></ul><h5 id=a-dockerfile>a. Dockerfile<a hidden class=anchor aria-hidden=true href=#a-dockerfile>#</a></h5><p>Docker commands used in the Dockerfile:</p><p><code>FROM python:3.9</code>: installs the base image for the image,</p><p><code>RUN pip install pandas</code> will the run any commands that,</p><p><code>WORKDIR /app</code> will create directory where the files of the image will be stored,</p><p><code>COPY pipeline.py pipeline.py</code> will copy the files from the local pc directory where the file is to the WORKDIR</p><p><code>ENTRYPOINT ["python","pipeline.py"]</code> directive in a Dockerfile allows the containers created from the image to run an executable after creation. ENTRYPOINT has two forms <em>exec</em> form and <em>shell</em> form. Here in the basic Dockerfile the <em>exec</em> form of entry point is being used.</p><h5 id=b-building-the-image>b. Building the image<a hidden class=anchor aria-hidden=true href=#b-building-the-image>#</a></h5><p><code>docker build -t test:pandas</code> : this command was used to build the <code>test</code> image with a tag of <code>pandas</code></p><h5 id=c-running-a-container-of-the-image>c. running a container of the image<a hidden class=anchor aria-hidden=true href=#c-running-a-container-of-the-image>#</a></h5><p><code>docker run -it test:pandas 2021-05-15</code> to this parameters can be passed as the <code>pipeline.py</code> is able to accept parameters using <code>sys.argv</code>.</p><p>One the container is run the only purpose of this container is to run the <code>pipeline.py</code> and the container closes once the execution of the container is completed.</p><h4 id=2-postgres>2. Postgres<a hidden class=anchor aria-hidden=true href=#2-postgres>#</a></h4><p>This step creates an image of Postgres db and uses <code>pgcli</code> to access the database</p><ul><li><em>for running a Postgres container the following command is used</em></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker run -it <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span> -e <span class=nv>POSTGRES_USER</span><span class=o>=</span><span class=s2>&#34;root&#34;</span> <span class=se>\ </span><span class=c1># The name of our PostgreSQL user</span>
</span></span><span class=line><span class=cl> -e <span class=nv>POSTGRES_PASSWORD</span><span class=o>=</span><span class=s2>&#34;root&#34;</span> <span class=se>\ </span><span class=c1># The password for our user</span>
</span></span><span class=line><span class=cl> -e <span class=nv>POSTGRES_DB</span><span class=o>=</span><span class=s2>&#34;ny_taxi&#34;</span> <span class=se>\ </span><span class=c1># The name we want for our database</span>
</span></span><span class=line><span class=cl> -v  /home/mujahid/PycharmProjects/zoomcamp_de/week1/ny_taxi_postgres_data <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span> :/var/lib/postgresql/data <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span> -p 5432:5432 <span class=se>\ </span><span class=c1># This maps a postgres port on our host machine to one in our containe</span>
</span></span><span class=line><span class=cl> postgres:13
</span></span></code></pre></div><p>-v flag - volumes is a way to map the folder on the container to the host machine file system to physically store the records. Docker doesn&rsquo;t keep the state next time when the container is started data must be available. We need to mount the folder on the host machine to the docker container.</p><p>Port on the host machine must also be mapped to the port on the docker container to access the Postgres database</p><p>the <code>docker run</code> command looks for an image of <code>postgres:13</code> if it does not find one then downloads it and creates an image and then runs a container</p><p>Side note: if the port is busy us this to find the process at running at the port[<a href=https://stackoverflow.com/questions/38249434/docker-postgres-failed-to-bind-tcp-0-0-0-05432-address-already-in-use>url</a>]
<code>sudo ss -lptn 'sport = :5432'</code>
and then <code>kill &lt;PID></code></p><p>With the container running now we can access it</p><ul><li><em>Accessing the Postgres db with pgcli</em></li></ul><p>install pgcli - its a client for Postgres</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pip install pgcli
</span></span></code></pre></div><p>then connect to the pgcli client to the database</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pgcli -h localhost -p <span class=m>5432</span> -u root -d ny_taxi 
</span></span></code></pre></div><p>and then check list of tables using</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>root@localhost:nytaxi&gt; <span class=se>\d</span>t
</span></span></code></pre></div><h4 id=3-populating--postgres-db-with-taxi-rides-dataset>3. Populating Postgres db with Taxi rides dataset<a hidden class=anchor aria-hidden=true href=#3-populating--postgres-db-with-taxi-rides-dataset>#</a></h4><p>The goal here is to</p><ol><li><p>Create a table (by generating schema) in the database to match the dataframe datatype.</p></li><li><p>load the data into the database chunk by chunk using an iterator as the taxi dataset has more than a million rows.</p><p><strong>Download data and convert to timestamp datatype for columns with timestamp related information</strong></p></li></ol><ul><li><p>Download the data from <a href=https://www.nyc.gov/site/tlc/about/tlc-trip-record-data.page>here</a></p><p>the data here is <code>.paraquet</code> format convert that to <code>.csv</code> using <code>df.to_csv</code> so that data can be handled easily and loaded in chunks.</p></li><li><p>convert time related to colums to timestamp datatype using <code>pd.to_datetime</code></p><p><strong>Create schema from the dataframe of the dataset for creating table in the database</strong></p></li><li><p>install sqlalchemy</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pip install sqlalchemy
</span></span></code></pre></div></li><li><p>to load this taxi data into the database first a table needs to be created. To generate a schema for the table to generate a DDL(data description language) statement using the following statement</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>pd</span><span class=o>.</span><span class=ow>is</span><span class=o>.</span><span class=n>sql</span><span class=o>.</span><span class=n>get_schema</span><span class=p>(</span><span class=n>df</span><span class=p>,</span><span class=n>name</span><span class=o>=</span><span class=s2>&#34;yello_taxi_data&#34;</span><span class=p>)</span>
</span></span></code></pre></div></li><li><p>using sqlalchemy create_engine generate correct Postgres compatible format of DDL and pass this connection engine to .get_schema statement to generate the schema</p></li><li><p>Use this DDL statement to create table in the postgres database</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># This creates a connection to the postgres db that is active at port 5432</span>
</span></span><span class=line><span class=cl><span class=n>engine</span> <span class=o>=</span> <span class=n>create_engine</span><span class=p>(</span><span class=s1>&#39;postgresql://root:root@localhost:5432/ny_taxi&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>engine</span><span class=o>.</span><span class=n>connect</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># This creates a schema for postgres db with a connection at `con`</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>io</span><span class=o>.</span><span class=n>sql</span><span class=o>.</span><span class=n>get_schema</span><span class=p>(</span><span class=n>df</span><span class=p>,</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;yellow_taxi_data&#39;</span><span class=p>,</span><span class=n>con</span><span class=o>=</span><span class=n>engine</span><span class=p>))</span>
</span></span></code></pre></div><p><strong>Load Data in chunks</strong></p></li><li><p>Load the df in chunks using and iterator so that we dont enter</p><ul><li>use the <code>iterator=True</code> for the <code>read_csv</code> statement; this converts the <code>df</code> to a standard python iterator.</li><li><code>next(df)</code> can be used to access the chunks</li></ul><p><strong>Write data into the table</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1>#this creates only the table with the schema of df but does not add any data as df.head(0)</span>
</span></span><span class=line><span class=cl><span class=n>df</span><span class=o>.</span><span class=n>head</span><span class=p>(</span><span class=mi>0</span><span class=p>)</span><span class=o>.</span><span class=n>to_sql</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;yellow_taxi_data&#39;</span><span class=p>,</span><span class=n>con</span><span class=o>=</span><span class=n>engine</span><span class=p>,</span><span class=n>if_exists</span><span class=o>=</span><span class=s1>&#39;replace&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1># this appends data(but chunk wise) to the table</span>
</span></span><span class=line><span class=cl><span class=n>df</span><span class=o>.</span><span class=n>to_sql</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;yellow_taxi_data&#39;</span><span class=p>,</span><span class=n>con</span><span class=o>=</span><span class=n>engine</span><span class=p>,</span><span class=n>if_exists</span><span class=o>=</span><span class=s1>&#39;append&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>To enter all the chunks the following code can be used</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>t_start</span> <span class=o>=</span> <span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>df</span> <span class=o>=</span> <span class=nb>next</span><span class=p>(</span><span class=n>df_iter</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>df</span><span class=o>.</span><span class=n>tpep_pickup_datetime</span><span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>tpep_pickup_datetime</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>df</span><span class=o>.</span><span class=n>tpep_dropoff_datetime</span><span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>to_datetime</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>tpep_dropoff_datetime</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>df</span><span class=o>.</span><span class=n>to_sql</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s1>&#39;yellow_taxi_data&#39;</span><span class=p>,</span><span class=n>con</span><span class=o>=</span><span class=n>engine</span><span class=p>,</span><span class=n>if_exists</span><span class=o>=</span><span class=s1>&#39;append&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>t_end</span> <span class=o>=</span> <span class=n>time</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;inserted another chunk, took </span><span class=si>%.3f</span><span class=s1> second &#39;</span><span class=o>%</span><span class=p>(</span><span class=n>t_end</span><span class=o>-</span><span class=n>t_start</span><span class=p>))</span>
</span></span></code></pre></div></li></ul><p><a href="https://www.youtube.com/watch?v=2JM-ziJt0WI&list=PL3MmuxUbc_hJed7dXYoJw8DoCuVHhGEQb">video</a></p><p><strong>References</strong></p><p><a href=https://github.com/ABZ-Aaron/DataEngineerZoomCamp/tree/master/week_1_basics_n_setup>https://github.com/ABZ-Aaron/DataEngineerZoomCamp/tree/master/week_1_basics_n_setup</a></p></div><footer class=post-footer><ul class=post-tags><li><a href=https://tayyabmujahid.github.io/tags/docker/>docker</a></li><li><a href=https://tayyabmujahid.github.io/tags/pgcli/>pgcli</a></li><li><a href=https://tayyabmujahid.github.io/tags/postgres/>postgres</a></li></ul><nav class=paginav><a class=next href=https://tayyabmujahid.github.io/posts/array_vs_vectors_cpp/><span class=title>Next »</span><br><span>Arrays vs Vectors in C++</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Test Post on twitter" href="https://twitter.com/intent/tweet/?text=Test%20Post&url=https%3a%2f%2ftayyabmujahid.github.io%2fposts%2ftest_post%2f&hashtags=docker%2cpgcli%2cpostgres"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Test Post on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2ftayyabmujahid.github.io%2fposts%2ftest_post%2f&title=Test%20Post&summary=Test%20Post&source=https%3a%2f%2ftayyabmujahid.github.io%2fposts%2ftest_post%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Test Post on reddit" href="https://reddit.com/submit?url=https%3a%2f%2ftayyabmujahid.github.io%2fposts%2ftest_post%2f&title=Test%20Post"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Test Post on facebook" href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2ftayyabmujahid.github.io%2fposts%2ftest_post%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Test Post on whatsapp" href="https://api.whatsapp.com/send?text=Test%20Post%20-%20https%3a%2f%2ftayyabmujahid.github.io%2fposts%2ftest_post%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Test Post on telegram" href="https://telegram.me/share/url?text=Test%20Post&url=https%3a%2f%2ftayyabmujahid.github.io%2fposts%2ftest_post%2f"><svg viewBox="2 2 28 28" height="30" width="30" fill="currentcolor"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg></a></div></footer></article></main><footer class=footer><span>&copy; 2022 <a href=https://tayyabmujahid.github.io/>TM Log</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>